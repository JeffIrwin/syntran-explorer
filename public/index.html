
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Syntran explorer</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <h1 id="heading1">Syntran explorer</h1>
        <h3>Help: <a href="https://github.com/JeffIrwin/syntran">documentation</a> </h3>
        <form id="textForm">
            <label for="text">Source:</label>
            <textarea id="text" name="text" rows="6" required>println("hello world");</textarea>
            <button type="submit">Run (Ctrl+Enter)</button>
        </form>

        <div id="responseContainer">
            <h2>Output:</h2>
            <pre id="responseText"></pre>
        </div>
    </div>

    <script>
        //if (process.env.NODE_ENV === "production") {
        ////if (env.NODE_ENV === "production") {
        //    console.log("client prod");
        //} else {
        //    console.log("client stg");
	//}

        function submitForm(form) {
            event.preventDefault(); // prevent default behavior

            // Set this to indicate possibly long-running jobs
            document.getElementById('responseText').innerText = "Running ...";

            // Create a FormData object from the form
            const formData = new FormData(form);
    
            //// Debug log
            //for (let [key, value] of formData.entries()) {
            //    console.log(`FormData entry: ${key} = ${value}`);
            //}
    
            // Send FormData using fetch and update the output with response
            // data
            fetch('/submit', {
                method: 'POST',
                body: formData
            })
            .then(response => response.text())
            .then(data => {
                document.getElementById('responseText').innerHTML = data;
            })
            .catch(error => {
                console.error('Fetch error:', error);
            });
        }

        document.getElementById('textForm').addEventListener('keydown', function(event) {
            if(event.key === "Enter" && (event.metaKey || event.ctrlKey)) {
		    submitForm(this);
	    }
        });

        document.getElementById('textForm').addEventListener('submit', function(event) {
	    submitForm(this);
        });

    </script>

</body>
</html>

